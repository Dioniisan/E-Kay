@page
@model EKay.Pages.Crear_CuentaModel
@{
    ViewData["Title"] = "Cree su cuenta";
}

<div class="d-flex justify-content-center centrado">
    <div class="shadow-lg p-3 mb-5 bg-white rounded">
        <div class="card" style="width: 30rem">
            <div class="card-body">
                <center>
                    <h2 class="card-title">Crear su cuenta</h2>
                </center>
                <form id="CrearCuenta" class="d-flex justify-content-center">
                <form id="crearCuenta" class="d-flex justify-content-center" enctype="multipart/form-data">
                    <div class="d-flex justify-content-center" style="width: 28rem;">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                <div class="form-group">
                                    @*<label asp-for="Cuenta.Correo"></label>*@
                                    <input name="nombre" type="text" class="form-control" role="textbox" placeholder="Nombre de su empresa">
                                </div>
                                <div class="form-group">
                                    @*<label asp-for="Cuenta.Correo"></label>*@
                                    <input name="nombrerepresentante" type="text" class="form-control" role="textbox" placeholder="Nombre de su representante">
                                </div>
                                <div class="form-group d-flex justify-content-center">
                                    @*<label asp-for="Cuenta.Contrasenia"></label>*@
                                    <input name="direccion" type="text" class="form-control" role="textbox" placeholder="Dirección">
                                </div>
                                <div class="form-group d-flex justify-content-center">
                                    @*<label asp-for="Cuenta.Contrasenia"></label>*@
                                    <input name="telefono" type="text" class="form-control" role="textbox" placeholder="Telefono">
                                </div>
                                <div class="form-group d-flex justify-content-center">
                                    @*<label asp-for="Cuenta.Contrasenia"></label>*@
                                    <input name="correo" type="text" class="form-control" role="textbox" placeholder="Correo">
                                </div>
                                <div class="form-group d-flex justify-content-center">
                                    @*<label asp-for="Cuenta.Contrasenia"></label>*@
                                    <input name="contrasenia" type="password" class="form-control" role="textbox" placeholder="Contraseña">
                                </div>
                                <br />
                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-outline-danger m-1">Crear Cuenta</button>
                                </div>
                            </li>
                        </ul>
                    </div>
                </form>
                <div>
                    <label id="mensaje" name="mensaje" css="color:red;"></label>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        const url = "https://localhost:44321/api/empresa/"
        var formulario = document.getElementById('CrearCuenta')

        const url = "https://localhost:44321/api/empresa"
        const $formulario = document.querySelector('#crearCuenta')

        const $label = document.querySelector('#mensaje')
        function displayMessage(message) {
            if (message)
                $label.textContent = "."
            else
                $label.textContent = "Ha ocurrido un problema."
        }
        $formulario.addEventListener('submit', (e) => {
            e.preventDefault();
            console.log('lmao')

            var dt = new FormData(formulario)
            console.log(dt)
            console.log(dt.get('Nombre'))
            console.log(dt.get('Direcc'))
            console.log(dt.get('Telef'))
            console.log(dt.get('Correo'))
            console.log(dt.get('Pass'))

            const dt = new FormData($formulario);

            //Mantener esto solo para pruebas
            console.log(dt.get('nombre'))
            console.log(dt.get('nombrerepresentante'))
            console.log(dt.get('direccion'))
            console.log(dt.get('telefono'))
            console.log(dt.get('correo'))
            console.log(dt.get('contrasenia'))


            //fetch
            fetch(url, {
                method: 'POST',
                body: dt
                
            })
                .then(res => res.json())
                .then(data => {
                    console.log(dt)
                })

                body: dt,

            })
                .then(res => res.json())
                .then(window.location.href = 'https://localhost:44348/Inicio')
                .catch(error => console.error('Error:', error))
                .then(response => displayMessage(response));
            //queda pendiente usar correo y contraseña para darselos tambien a cuenta
        })
    </script>

}